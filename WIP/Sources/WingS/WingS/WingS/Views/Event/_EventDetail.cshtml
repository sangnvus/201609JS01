
<body id="pageBody">
    <link href="~/Content/css/EventDetail.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="~/Content/css/progressbar.css">
    <!-- PAGE LEVEL PLUGIN STYLES -->
    <link href="~/Content/css/plugins/datatables/datatables.css" rel="stylesheet">
    <link href="~/Content/css/pagination.css" rel="stylesheet" type="text/css" />
    <!-- END PAGE LEVEL PLUGIN STYLES -->

<!-- REFERENCE CHATBOX CSS STYLE -->
    <link href="~/Content/css/ChatStyle.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="~/Content/css/timeline.css">
    <link href="~/Content/css/ThreadDetail.css" rel="stylesheet" type="text/css" />
    <script src="../../Content/scripts/lightbox/dist/js/lightbox-plus-jquery.min.js" type="text/javascript"></script>
<div id="divBoxed" class="container">

<div class="transparent-bg" style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;z-index: -1; zoom: 1;"></div>

<div class="divPanel notop nobottom">
    @Html.Partial("../Home/_NavigationBar")
    <div class="row-fluid">
        <div class="span12">
            <div id="contentInnerSeparator"></div>
        </div>
    </div>
</div>

<div class="contentArea">

<div class="divPanel notop page-content">

<div class="breadcrumbs" style="font-size: 18px; padding-bottom:20px;">
    <a href="Home.html">Trang chủ</a> &nbsp;/&nbsp; <span>Chi tiết</span>
</div>

<!--Star event content -->

<div class="row-fluid">
    <section class="col-8">
        <!-- Video clip -->
        <iframe width="745px" height="400" src="{{Event.VideoUrl}}" frameborder="0" allowfullscreen></iframe>
        <!-- Title -->
    </section>
    <aside class="col-4">
        <!-- Process Donate -->
        <div class="urgent-progress">
            <div class="amount">
                <span style="font-size: 22px;font-weight: 300;">HIỆN TẠI:</span>
                <span style="font-size: 22px;font-weight: 700;">123,567,000 VND</span>
            </div>

            <div class="progressbar position" data-percent="75" data-duration="1000" data-color="#ccc,#e05f03">

            </div>
            <div class="amount">
                <span style="font-size: 22px;font-weight: 300;">DỰ KIẾN:</span>
                <span style="font-size: 22px;font-weight: 700;">{{Event.ExpectedMoney}} VNĐ</span>
            </div>

        </div>
    </aside>
</div>
<div class="row-fluid">
    <section class="col-12">
        <div class="title">{{Event.EventName}}</div>
        <!-- Infor basic of event -->
        <div class="info">
            <span>Tạo bởi:</span> {{Event.CreatorName}}<span class="space"></span>
            <span>Thể loại:</span> {{Event.EventType}}<span class="space"></span>
            <span>
                                <i class="fa fa-calendar" aria-hidden="true"></i>
                                {{Event.CreatedDate}}
                            </span> | <a href="#" onclick="return false;" data-toggle="modal" data-target="#sendMessage"><i class="fa fa-envelope"></i></a>
        </div>
        <br>
        <!-- Tab content -->
        <ul class="nav nav-tabs">
            <li class="active"><a data-toggle="tab" href="#contentEvt" onclick="return false">Nội dung</a></li>
            <li><a data-toggle="tab" href="#AlbumImage" onclick="return false">Hình Ảnh</a></li>
            <li><a data-toggle="tab" href="#timelineTab" onclick="return false">Lịch trình</a></li>
            <li><a data-toggle="tab" href="#list" onclick="return false">Danh sách đóng góp</a></li>
            <li><a data-toggle="tab" href="#contact" onclick="return false">Liên hệ</a></li>

        </ul>
        <div class="tab-content">
            <!-- Content -->
            <div id="contentEvt" class="tab-pane fade in active" style="padding:0px 5px 5px 5px;">
                <div class="contentEvent">
                    <p ng-bind-html="Event.Content"><p>
                </div>
                <div>
                    <p style="font-weight: 600;"><strong>Sự kiện được tổ chức tại:&nbsp;</strong>{{Event.Location}}</p>
                </div>
                                
                <br>

            </div>
            <!-- Timeline -->
            <div id="timelineTab" class="tab-pane fade" >
                <section id="timeline" >
                    <article ng-repeat="item in EventTimeLine">
                        <div class="inner">
                            <span class="date">
                                                <span class="month">{{Event.StartedDate}}</span>
                                            </span>
                            <h2>Từ ngày {{item.FromDate}} Đến ngày {{item.ToDate}}</h2>
                            <p>{{item.Content}}</p>
                        </div>
                    </article>
                    @*<article>
                                        <div class="inner">
                                            <span class="date">
                                                <span class="day">26<sup>th</sup></span>
                                                <span class="month">Jan</span>
                                                <span class="year">2014</span>
                                            </span>
                                            <h2>The Title</h2>
                                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean quis rutrum nunc, eget dictum massa. Nam faucibus felis nec augue adipiscing, eget commodo libero mattis.</p>
                                        </div>
                                    </article>
                                    <article>
                                        <div class="inner">
                                            <span class="date">
                                                <span class="day">26<sup>th</sup></span>
                                                <span class="month">Jan</span>
                                                <span class="year">2014</span>
                                            </span>
                                            <h2>The Title</h2>
                                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean quis rutrum nunc, eget dictum massa. Nam faucibus felis nec augue adipiscing, eget commodo libero mattis.</p>
                                        </div>
                                    </article>*@
                </section>
            </div>

            <!-- List User Donated -->

            <div id="list" class="tab-pane fade">
                <!-- begin NEW USER TABLES ROW -->
                <div class="portlet portlet-default">
                    <div class="portlet-heading">
                        <div class="portlet-title">
                            <h4>Danh sách đóng góp</h4>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <div class="portlet-body">
                        <div class="table-responsive">
                            <table id="example-table" class="table table-striped table-bordered table-hover table-green">
                                <thead>
                                <tr>
                                    <th style="width: 30px;">STT</th>
                                    <th style="width: 215px;">HỌ VÀ TÊN</th>
                                    <th style="width: 215px;">SỐ TIỀN<span style="padding-left:110px;">VND</span></th>
                                    <th>GHI CHÚ</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>Đỗ Văn Tuấn</td>
                                    <td>1.000.000</td>
                                    <td>Quyên góp là việc làm tốt </td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>Gia Đình Cô Diệu Đức và bạn</td>
                                    <td>500.000</td>
                                    <td>Quyên góp là việc làm tốt</td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>Philip</td>
                                    <td>500.000</td>
                                    <td>Quyên góp là việc làm tốt</td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td>Maria</td>
                                    <td>500.000</td>
                                    <td>Quyên góp là việc làm tốt</td>
                                </tr>
                                <tr>
                                    <td>5</td>
                                    <td>Julia</td>
                                    <td>3.500.000</td>
                                    <td>Quyên góp là việc làm tốt</td>
                                </tr>
                                <tr>
                                    <td>6</td>
                                    <td>Jane</td>
                                    <td>3.500.000</td>
                                    <td>Quyên góp là việc làm tốt</td>
                                </tr>
                                <tr>
                                    <td>7</td>
                                    <td>Susan</td>
                                    <td>Crane</td>
                                    <td>Quyên góp là việc làm tốt</td>
                                </tr>
                                <tr>
                                    <td>8</td>
                                    <td>Lucas</td>
                                    <td>3.500.000</td>
                                    <td>Quyên góp là việc làm tốt</td>
                                </tr>
                                <tr>
                                    <td>9</td>
                                    <td>Mark</td>
                                    <td>3.500.000</td>
                                    <td>Quyên góp là việc làm tốt</td>
                                </tr>
                                <tr>
                                    <td>10</td>
                                    <td>Hilde</td>
                                    <td>3.500.000</td>
                                    <td>Quyên góp là việc làm tốt</td>
                                </tr>
                                <tr>
                                    <td>11</td>
                                    <td>John</td>
                                    <td>3.500.000</td>
                                    <td>Quyên góp là việc làm tốt</td>
                                </tr>

                                </tbody>
                            </table>
                        </div>
                        <!-- /.table-responsive -->
                    </div>
                    <!-- /.portlet-body -->
                </div>
                <!-- /.portlet -->

            </div>

            <!-- Contact -->
            <div id="contact" class="tab-pane fade">
                <p style="background-color: #f6f6f6;" ng-bind-html="SkipValidation(Event.ContactInfo)">

                </p>
            </div>

            <!-- Image -->
            <div id="AlbumImage" class="tab-pane fade">
                <div class="row-fluid">
                    <div>
                        <a ng-repeat="item in Event.ImageAlbum" class="example-image-link" href="{{item}}" data-lightbox="example-set" data-title="Click the right half of the image to move forward.">
                            <img style="height: 175px;" class="example-image" src="{{item}}" alt="" />
                        </a>
                    </div>

                </div>
            </div>
        </div>

    </section>
    <!-- Aside content -->

</div>
<br />
<hr>
<div class="circle row-fluid" style="margin-top: 5px;" align="center">
    <!-- <div class="span2">
        <span id="like" onclick="changeLikeStt()"><i class="fa fa-thumbs-up" aria-hidden="true" title="Số lượt thích"></i> 50</span>
    </div>
    <div class="span2">
        <i class="fa fa-users" aria-hidden="true" title="Số người tham gia sự kiện"></i> 500
    </div>
    <div class="span2">
        <i class="icon-share-alt" title="Hãy chia sẻ nội dung này đến mọi người"></i> Chia sẻ
    </div>
    <div style="margin-left: 400px;">
        <i class="icon-flag"></i> Báo cáo sự kiện
    </div> -->
    <div class="span2 offset2">
        <a href="#" class="stylish">50</a>
        <h3>Tham gia</h3>
    </div>
    <div class="span2">
        <a href="#" class="stylish">50</a>
        <h3>Thích</h3>
    </div>
    <div class="span2">
        <a href="#" class="stylish">Chia sẻ</a>
    </div>
    <div class="span2">
        <a href="#" class="stylish">50</a>
    </div>
</div>
<h2>Bình luận</h2>
<div class="row-fluid">
    <!--Edit Main Content Area here-->
    <div class="span10 offset1" id="divMain">
        <div class="row-fluid" id="isComment">
            <br />
            <div class="span6 offset1">
                <div class="alert alert-danger" style="background-color: rgb(240, 240, 240); color: rgb(41, 41, 41);">
                    <div class="row-fluid">
                        <h3 style="margin-top:15px;"><strong>Hiện tại chưa có bình luận nào </strong></h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="media" ng-repeat="item in CommentEvent| limitTo: paginationLimit()">
            <a class="pull-left" href="#">
                <img src="{{item.UserImageProfile}}" style="width:64px; height:64px;" class="img-circle" alt="" />
            </a>
            <div class="media-body">
                <h4 class="media-heading">{{item.UserCommentedName}} <span><small>{{item.CommentedTime}}</small></span></h4>
                {{item.Content}}
            </div>
            <br>
            <div class="media-footer">
                <a href="#" class="voteButton" onclick="return false;">Vote | 50 </a> <a href="#" style="color: #999; font-size: 13px;"> DownVote </a> | <a href="#" onclick="return false" style="color: #999; font-size: 13px;" ng-click="showReply[$index]=true;getSubcomment(item.CommentId, $index)"> Trả lời ({{item.NumberSubComment}}) </a>
            </div>
            <hr>
            <div ng-show="showReply[$index]">
                <div class="media" style="margin-left: 67px;" ng-repeat="subcomment in SubCommentEvent[$index]">
                    <a class="pull-left" href="#">
                        <img src="{{subcomment.UserImageProfile}}" style="width:45px; height:45px;"  class="img-circle" alt="" />
                    </a>
                    <div class="media-body">
                        <h4 class="media-heading">{{subcomment.UserCommentedName}} <span><small>{{subcomment.CommentedTime}}</small></span></h4>
                        {{subcomment.Content}}
                    </div>
                    <hr />
                </div>

                <div ng-if="User_Information.IsAuthen" style="margin-left:67px;">
                    <br />
                    <a class="pull-left" href="#">
                        <img src="{{User_Information.ProfileImage}}" style="width:40px; height:40px;" class="img-circle" alt="" />
                    </a>&nbsp;&nbsp;&nbsp;<input class="subContent" type="text" placeholder="Nhập bình luận" style="width:50%; height:40px; " ng-model="$parent.Subcontent" my-Enter="addSubComment(Subcontent,{{item.CommentId}},$index)" />
                    <hr />
                </div>
            </div>
        </div>
        <span style="margin-left:64px;"></span><a href="#" onclick="return false;" ng-show="hasMoreItemsToShow()" ng-click="showMoreItems()">Xem thêm bình luận</a>
        <br />
        <div ng-if="User_Information.IsAuthen">
            <a class="pull-left" href="#">
                <img src="{{User_Information.ProfileImage}}" style="width:40px; height:40px; margin-left:25px; " class="img-rounded" alt="" />
            </a>&nbsp;&nbsp;&nbsp;<textarea placeholder="Nhập bình luận" style="width:75%; height:50px; " ng-model="$parent.content" my-Enter="addContent(content)"></textarea>
        </div>
        <br />
        <div align="center" style="margin-right:15px;">
            <a class="btn btn-primary" href="#" ng-click="reloadComment()" onclick="return false;"><i class="icon-refresh icon-spin"></i> Tải lại bình luận</a>
        </div>
    </div>
</div>





<div class="modal fade" id="sendMessage" role="dialog" hidden>
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Gửi tin nhắn tới tổ chức: WingS</h4>
            </div>
            <div class="modal-message" align="center" style="margin-top:50px; margin-bottom:50px;" >
                Bạn đã gửi tin nhắn thành công, hãy kiểm tra tại <a href="#">Message</a>
            </div>
            <div class="modal-body">
                <input type="text" name="title" id="title" class="input-block-level" placeholder="Chủ đề" ng-model="titleMessage" />
                <textarea rows="11" name="message" id="message" class="input-block-level" placeholder="Nội dung"  ng-model="content"></textarea>
            </div>
            <div class="modal-footer">
                <div class="sendMessage">
                    <button type="button" ng-click="sendMessage(titleMessage, content)" class="btn btn-info pull-right">Gửi tin nhắn</button>
                </div>
                <div class="closeForm">
                    <button type="button" class="btn btn-info pull-right" data-dismiss="modal">Đóng</button>
                </div>
            </div>
        </div>

    </div>
</div>

<hr>
<!--Rank of Organization-->
<h2>Xếp hạng các tổ chức</h2>
<div class="row-fluid">

    <div class="span4" align="center">
        <h5 class="text-info">Tổ chức:</h5>
        <img src="images/services-image.jpg" class="img-polaroid img-circle" style="margin:5px 0px 15px;" alt="">
        <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem ipsum dolor sit amet, consectetur adipiscing elit.<br /><a href="#">Read More &raquo;</a></p>
    </div>
    <div class="span4" align="center">
        <h5 class="text-info">Tổ chức:</h5>
        <img src="images/services-image.jpg" class="img-polaroid img-circle" style="margin:5px 0px 15px;" alt="">
        <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem ipsum dolor sit amet, consectetur adipiscing elit.<br /><a href="#">Read More &raquo;</a></p>
    </div>
    <div class="span4" align="center">
        <h5 class="text-info">Tổ chức:</h5>
        <img src="images/services-image.jpg" class="img-polaroid img-circle" style="margin:5px 0px 15px;" alt="">
        <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem ipsum dolor sit amet, consectetur adipiscing elit.<br /><a href="#">Read More &raquo;</a></p>
    </div>
</div>
</div>

<div id="footerOuterSeparator"></div>

@Html.Partial("../Home/_Footer")
<br/><br/><br/>

<div class="chatbox chatbox--tray chatbox--empty">
    <div class="chatbox__title">
        <h5><a href="">Thảo Luận</a></h5>
        <button class="chatbox__title__tray">
            <span></span>
        </button>
        <button class="chatbox__title__close">
            <span>
                            <svg viewBox="0 0 12 12" width="12px" height="12px">
                                <line stroke="#FFFFFF" x1="11.75" y1="0.25" x2="0.25" y2="11.75"></line>
                                <line stroke="#FFFFFF" x1="11.75" y1="11.75" x2="0.25" y2="0.25"></line>
                            </svg>
                        </span>
        </button>
    </div>
    <div id="msgContainer" class="chatbox__body">

    </div>
    <form class="chatbox__credentials">
        @if (User.Identity == null || !User.Identity.IsAuthenticated)
        {
            <div class="require_Login">
                <p>Bạn cần đăng nhập để có thể xem được nội dung thảo luận</p>

                <h3><a style:align="center" href=@Url.Content("/#/Login")> Đăng nhập</a></h3>
            </div>
        }
        else
        {
            <button type="submit" id="btnStartChat" class="btn btn-success btn-block">Vào phòng thảo luận</button>
        }
        <input id="hdId" type="hidden" />
        <input id="hdUserId" type="hidden" />
        <input id="hdEventId" type="hidden" />
    </form>
    <textarea id="txtMessage" class="chatbox__message" placeholder="Write something...."></textarea>
    <span class="input-group-btn">
        <button class="btn btn-primary btn-sm" id="btnSendMsg">Senddddddddddd</button>
    </span>
</div>

<!-- PAGE LEVEL PLUGIN SCRIPTS -->
<script type="text/javascript" src="../../Content/js/plugins/datatables/jquery.dataTables.js"></script>
<script type="text/javascript" src="../../Content/js/plugins/datatables/datatables-bs3.js"></script>
<script type="text/javascript" src="../../Content/js/plugins/datatables/advanced-tables-demo.js"></script>
<!-- END PAGE LEVEL PLUGIN SCRIPTS -->
<script type="text/javascript" src="../../Content/js/progressbar.js"></script>
<script type="text/javascript">
    $(".progressbar").loading();
    $('input').on('click', function () {
        $(".progressbar").loading();
    });
    $(".modal-message").hide();
    $(".closeForm").hide();
</script>

<!-- CHATBOX SCRIPTS -->
<script type="text/javascript">
    (function ($) {
        $(document).ready(function () {
            var $chatbox = $('.chatbox'),
                $chatboxTitle = $('.chatbox__title'),
                $chatboxTitleClose = $('.chatbox__title__close'),
                $chatboxCredentials = $('.chatbox__credentials');
            $chatboxTitle.on('click', function () {
                $chatbox.toggleClass('chatbox--tray');
            });
            $chatboxTitleClose.on('click', function (e) {
                e.stopPropagation();
                $chatbox.addClass('chatbox--closed');
            });
            $chatbox.on('transitionend', function () {
                if ($chatbox.hasClass('chatbox--closed')) $chatbox.remove();
            });
            $chatboxCredentials.on('submit', function (e) {                    
                e.preventDefault();
                $chatbox.removeClass('chatbox--empty');
            });
        });
    })(jQuery);
</script></div></div>
    
    
@if (User.Identity.Name != "")
{
    <script type="text/javascript">
        window.hubReady.done(function () {
            registerEvent( window.globalHub);
        });
        function registerEvent(global)
        {
            $("#btnStartChat").click(function () {
                global.server.joinRoom(eventId);
            });
            $('.chatbox__title__close').click(function () {
                global.server.disconnectRoom(eventId);
            });
        }
    </script>
}
        @*$("#txtMessage").keypress(function (e) {
            if (e.which == 13) {
                $('#btnSendMsg').click();
            }
        });

        $('#btnSendMsg').click(function () {
            var msg = $("#txtMessage").val();
            if (msg.length > 0) {

                var userId = $('#hdUserName').val();
                chatHub.server.sendMessageToAll(userId, msg);
                $("#txtMessage").val('');
            }
        });

    }

    function registerClientMethods(chatHub) {
        //Calls when user enter chat room
        chatHub.client.onConnected = function (id, userId, allUsers, messages) {

            $('#hdId').val(id);
            $('#hdUserId').val(userId);
            $('#hdEventId').val(eventId);


            for (i = 0; i < allUsers.length; i++) {
                // Add Existing Messages
                for (i = 0; i < messages.length; i++)
                {
                    AddMessage(messages[i].UserId, messages[i].Message);
                }
            }

            // On New User Connected
            chatHub.client.onNewUserConnected = function (id, userId, eventId) {
                AddUser(chatHub, id, userId, eventId);
            }

            chatHub.client.messageReceived = function (userId, message) {
                AddMessage(UserId, message);
            }
        }
    }

    //Add User
    function AddUser(chatHub, id, userId, eventId) {

    }

    // Add Message
    function AddMessage(userId, message) {
        $('#msgContainer').append('<div class="message"><span class="userId">' + userId + '</span>: ' + message + '</div>');

        var height = $('#msgContainer')[0].scrollHeight;
        $('#msgContainer').scrollTop(height);
    }
</script>*@

        </body>
